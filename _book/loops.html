<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kappale 11 Toistorakenteet (loops) | R-ohjelmoinnin perusteet</title>
  <meta name="description" content="This repository contains materials used in an introductory level R course at university of Eastern Finland." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Kappale 11 Toistorakenteet (loops) | R-ohjelmoinnin perusteet" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This repository contains materials used in an introductory level R course at university of Eastern Finland." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kappale 11 Toistorakenteet (loops) | R-ohjelmoinnin perusteet" />
  
  <meta name="twitter:description" content="This repository contains materials used in an introductory level R course at university of Eastern Finland." />
  

<meta name="author" content="Anton Klåvus (2020), converted to bookdown by Juho Kopra (2021)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ifelse.html"/>

<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-ohjelmoinnin perusteet</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html"><i class="fa fa-check"></i>R-kurssi</a>
<ul>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html#sisällysluettelo"><i class="fa fa-check"></i>Sisällysluettelo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html"><i class="fa fa-check"></i>Alkuvalmistelut</a>
<ul>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rn-ja-rstudion-asentaminen-omalle-tietokoneelle"><i class="fa fa-check"></i>R:n ja RStudion asentaminen omalle tietokoneelle</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudion-asennus-yliopiston-koneelle"><i class="fa fa-check"></i>RStudion asennus yliopiston koneelle</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudion-käyttö"><i class="fa fa-check"></i>RStudion käyttö</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rcourse-paketin-asentaminen"><i class="fa fa-check"></i>Rcourse-paketin asentaminen</a>
<ul>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#r-paketit"><i class="fa fa-check"></i>R-paketit</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#asentaminen"><i class="fa fa-check"></i>Asentaminen</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#opiskelu-ja-tenttiminen-rcourse-paketin-avulla"><i class="fa fa-check"></i>Opiskelu ja tenttiminen Rcourse-paketin avulla</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#tehtävien-tallentaminen-skripteihin-rstudiolla"><i class="fa fa-check"></i>Tehtävien tallentaminen skripteihin RStudiolla</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Johdanto</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what_R"><i class="fa fa-check"></i><b>1.1</b> Mikä R on ja mitä sillä tehdään?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html"><i class="fa fa-check"></i><b>2</b> Muuttujat ja vektorit</a>
<ul>
<li class="chapter" data-level="2.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#muuttujat-variables"><i class="fa fa-check"></i><b>2.1</b> Muuttujat (Variables)</a></li>
<li class="chapter" data-level="2.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#kommentit"><i class="fa fa-check"></i><b>2.2</b> Kommentit</a></li>
<li class="chapter" data-level="2.3" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#vektorit-vectors"><i class="fa fa-check"></i><b>2.3</b> Vektorit (Vectors)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#ei-numeeriset-vektorit"><i class="fa fa-check"></i><b>2.3.1</b> Ei-numeeriset vektorit</a></li>
<li class="chapter" data-level="2.3.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#vektorien-indeksointi-ja-leikkely"><i class="fa fa-check"></i><b>2.3.2</b> Vektorien indeksointi ja leikkely</a></li>
<li class="chapter" data-level="2.3.3" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#puuttuvat-arvot"><i class="fa fa-check"></i><b>2.3.3</b> Puuttuvat arvot</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#extra"><i class="fa fa-check"></i><b>2.4</b> Extra: Alkeistietotyypit ja puuttuvat arvot</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>3</b> Tietotyypit</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-types.html"><a href="data-types.html#data-frame"><i class="fa fa-check"></i><b>3.1</b> Data frame</a></li>
<li class="chapter" data-level="3.2" data-path="data-types.html"><a href="data-types.html#matriisi"><i class="fa fa-check"></i><b>3.2</b> Matriisi</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-types.html"><a href="data-types.html#matriisin-luominen"><i class="fa fa-check"></i><b>3.2.1</b> Matriisin luominen</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-types.html"><a href="data-types.html#matriisin-koko"><i class="fa fa-check"></i><b>3.2.2</b> Matriisin koko</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-types.html"><a href="data-types.html#matriisin-indeksointi"><i class="fa fa-check"></i><b>3.2.3</b> Matriisin indeksointi</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-types.html"><a href="data-types.html#matriisien-rakentaminen-vektoreista"><i class="fa fa-check"></i><b>3.2.4</b> Matriisien rakentaminen vektoreista</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-types.html"><a href="data-types.html#rivien-ja-sarakkeiden-nimeäminen"><i class="fa fa-check"></i><b>3.2.5</b> Rivien ja sarakkeiden nimeäminen</a></li>
<li class="chapter" data-level="3.2.6" data-path="data-types.html"><a href="data-types.html#matriiseilla-laskeminen"><i class="fa fa-check"></i><b>3.2.6</b> Matriiseilla laskeminen</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-types.html"><a href="data-types.html#tietotyyppien-tarkastelu"><i class="fa fa-check"></i><b>3.3</b> Tietotyyppien tarkastelu</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-types.html"><a href="data-types.html#view"><i class="fa fa-check"></i><b>3.3.1</b> View()</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-types.html"><a href="data-types.html#str"><i class="fa fa-check"></i><b>3.3.2</b> str()</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-types.html"><a href="data-types.html#head"><i class="fa fa-check"></i><b>3.3.3</b> head()</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-types.html"><a href="data-types.html#extra-taulukko-ja-lista"><i class="fa fa-check"></i><b>3.4</b> Extra: Taulukko ja lista</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-types.html"><a href="data-types.html#taulukko"><i class="fa fa-check"></i><b>3.4.1</b> Taulukko</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-types.html"><a href="data-types.html#lista"><i class="fa fa-check"></i><b>3.4.2</b> Lista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>4</b> Datan lukeminen</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reading-data.html"><a href="reading-data.html#tekstitiedostot"><i class="fa fa-check"></i><b>4.1</b> Tekstitiedostot</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="reading-data.html"><a href="reading-data.html#read.table"><i class="fa fa-check"></i><b>4.1.1</b> read.table()</a></li>
<li class="chapter" data-level="4.1.2" data-path="reading-data.html"><a href="reading-data.html#read.csv"><i class="fa fa-check"></i><b>4.1.2</b> read.csv()</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="reading-data.html"><a href="reading-data.html#data-framen-rakenteen-tutkiminen"><i class="fa fa-check"></i><b>4.2</b> Data framen rakenteen tutkiminen</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reading-data.html"><a href="reading-data.html#rn-sisäänrakennetut-datasetit"><i class="fa fa-check"></i><b>4.2.1</b> R:n sisäänrakennetut datasetit</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reading-data.html"><a href="reading-data.html#muut-tiedostot"><i class="fa fa-check"></i><b>4.3</b> Muut tiedostot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="reading-data.html"><a href="reading-data.html#excel"><i class="fa fa-check"></i><b>4.3.1</b> Excel</a></li>
<li class="chapter" data-level="4.3.2" data-path="reading-data.html"><a href="reading-data.html#spss"><i class="fa fa-check"></i><b>4.3.2</b> SPSS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Datan muokkaaminen</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#osajoukkojen-valinta"><i class="fa fa-check"></i><b>5.1</b> Osajoukkojen valinta</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling.html"><a href="data-wrangling.html#faktorit"><i class="fa fa-check"></i><b>5.2</b> Faktorit</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling.html"><a href="data-wrangling.html#uuden-muuttujan-tai-rivin-luonti-datakehikkoon"><i class="fa fa-check"></i><b>5.3</b> Uuden muuttujan tai rivin luonti datakehikkoon</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-framen-käsittely"><i class="fa fa-check"></i><b>5.3.1</b> Data framen käsittely</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="khi-toiseen-testi.html"><a href="khi-toiseen-testi.html"><i class="fa fa-check"></i><b>6</b> Khi toiseen -testi</a></li>
<li class="chapter" data-level="7" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>7</b> Kuvaajien piirtäminen</a>
<ul>
<li class="chapter" data-level="7.1" data-path="plotting.html"><a href="plotting.html#korkean-tason-piirtofunktiot"><i class="fa fa-check"></i><b>7.1</b> Korkean tason piirtofunktiot</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="plotting.html"><a href="plotting.html#plot"><i class="fa fa-check"></i><b>7.1.1</b> plot()</a></li>
<li class="chapter" data-level="7.1.2" data-path="plotting.html"><a href="plotting.html#muut-korkean-tason-funktiot"><i class="fa fa-check"></i><b>7.1.2</b> Muut korkean tason funktiot</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="plotting.html"><a href="plotting.html#alemman-tason-grafiikkatoiminnot"><i class="fa fa-check"></i><b>7.2</b> Alemman tason grafiikkatoiminnot</a></li>
<li class="chapter" data-level="7.3" data-path="plotting.html"><a href="plotting.html#kuvaajien-piirtäminen-käytännössä"><i class="fa fa-check"></i><b>7.3</b> Kuvaajien piirtäminen käytännössä</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>8</b> Lineaariset mallit ja tilastolliset jakaumat</a>
<ul>
<li class="chapter" data-level="8.1" data-path="statistics.html"><a href="statistics.html#factor-vektorit"><i class="fa fa-check"></i><b>8.1</b> Factor-vektorit</a></li>
<li class="chapter" data-level="8.2" data-path="statistics.html"><a href="statistics.html#linear_models"><i class="fa fa-check"></i><b>8.2</b> Lineaariset mallit</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="statistics.html"><a href="statistics.html#teoria"><i class="fa fa-check"></i><b>8.2.1</b> Teoria</a></li>
<li class="chapter" data-level="8.2.2" data-path="statistics.html"><a href="statistics.html#esimerkki"><i class="fa fa-check"></i><b>8.2.2</b> Esimerkki</a></li>
<li class="chapter" data-level="8.2.3" data-path="statistics.html"><a href="statistics.html#tarkempia-tietoja-mallista"><i class="fa fa-check"></i><b>8.2.3</b> Tarkempia tietoja mallista</a></li>
<li class="chapter" data-level="8.2.4" data-path="statistics.html"><a href="statistics.html#ennustaminen"><i class="fa fa-check"></i><b>8.2.4</b> Ennustaminen</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="statistics.html"><a href="statistics.html#korrelaatio"><i class="fa fa-check"></i><b>8.3</b> Korrelaatio</a></li>
<li class="chapter" data-level="8.4" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>8.4</b> Todennäköisyysjakaumat R:ssä</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="statistics.html"><a href="statistics.html#esimerkki-normaalijakauma"><i class="fa fa-check"></i><b>8.4.1</b> Esimerkki: normaalijakauma</a></li>
<li class="chapter" data-level="8.4.2" data-path="statistics.html"><a href="statistics.html#muita-jakaumia"><i class="fa fa-check"></i><b>8.4.2</b> Muita jakaumia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>9</b> Funktiot</a>
<ul>
<li class="chapter" data-level="9.1" data-path="functions.html"><a href="functions.html#funktion-käsite"><i class="fa fa-check"></i><b>9.1</b> Funktion käsite</a></li>
<li class="chapter" data-level="9.2" data-path="functions.html"><a href="functions.html#r-funktiot"><i class="fa fa-check"></i><b>9.2</b> R-funktiot</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="functions.html"><a href="functions.html#funktioiden-määrittely"><i class="fa fa-check"></i><b>9.2.1</b> Funktioiden määrittely</a></li>
<li class="chapter" data-level="9.2.2" data-path="functions.html"><a href="functions.html#argumentit-ja-funktion-kutsuminen"><i class="fa fa-check"></i><b>9.2.2</b> Argumentit ja funktion kutsuminen</a></li>
<li class="chapter" data-level="9.2.3" data-path="functions.html"><a href="functions.html#funktio-ilman-argumentteja"><i class="fa fa-check"></i><b>9.2.3</b> Funktio ilman argumentteja</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="functions.html"><a href="functions.html#arvojen-palautus"><i class="fa fa-check"></i><b>9.3</b> Arvojen palautus</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="functions.html"><a href="functions.html#usean-arvon-palautus"><i class="fa fa-check"></i><b>9.3.1</b> Usean arvon palautus</a></li>
<li class="chapter" data-level="9.3.2" data-path="functions.html"><a href="functions.html#palautus-ilman-return-käskyä"><i class="fa fa-check"></i><b>9.3.2</b> Palautus ilman return-käskyä</a></li>
<li class="chapter" data-level="9.3.3" data-path="functions.html"><a href="functions.html#funktio-ilman-tulosta"><i class="fa fa-check"></i><b>9.3.3</b> Funktio ilman tulosta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ifelse.html"><a href="ifelse.html"><i class="fa fa-check"></i><b>10</b> Ehtorakenteet</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ifelse.html"><a href="ifelse.html#loogiset-operaattorit"><i class="fa fa-check"></i><b>10.1</b> Loogiset operaattorit</a></li>
<li class="chapter" data-level="10.2" data-path="ifelse.html"><a href="ifelse.html#ehtorakenteet"><i class="fa fa-check"></i><b>10.2</b> Ehtorakenteet</a></li>
<li class="chapter" data-level="10.3" data-path="ifelse.html"><a href="ifelse.html#alkioiden-poimiminen-vektorista-tietyh-ehdon-perusteella"><i class="fa fa-check"></i><b>10.3</b> Alkioiden poimiminen vektorista tietyh ehdon perusteella</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>11</b> Toistorakenteet (loops)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="loops.html"><a href="loops.html#for-silmukka"><i class="fa fa-check"></i><b>11.1</b> For-silmukka</a></li>
<li class="chapter" data-level="11.2" data-path="loops.html"><a href="loops.html#while-slimukat"><i class="fa fa-check"></i><b>11.2</b> While-slimukat</a></li>
<li class="chapter" data-level="11.3" data-path="loops.html"><a href="loops.html#sisäkkäiset-silmukat-nested-loops"><i class="fa fa-check"></i><b>11.3</b> Sisäkkäiset silmukat (nested loops)</a></li>
<li class="chapter" data-level="11.4" data-path="loops.html"><a href="loops.html#iterointiin-puuttuminen-next-ja-break"><i class="fa fa-check"></i><b>11.4</b> Iterointiin puuttuminen: next ja break</a></li>
<li class="chapter" data-level="11.5" data-path="loops.html"><a href="loops.html#apply-funktiot"><i class="fa fa-check"></i><b>11.5</b> Apply-funktiot</a></li>
<li class="chapter" data-level="11.6" data-path="loops.html"><a href="loops.html#vinkkejä-tehtäviin"><i class="fa fa-check"></i><b>11.6</b> Vinkkejä tehtäviin</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Julkaistu bookdownilla.</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-ohjelmoinnin perusteet</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="loops" class="section level1" number="11">
<h1><span class="header-section-number">Kappale 11</span> Toistorakenteet (loops)</h1>
<p>Toistorakenne toistaa annettua koodia. Toistorakenteet ovat ehtorakenteiden ohella ohjelmoinnin perusrakennuspalikoita. Tässä osiossa tutustutaan kahteen yleisimpään tapaukseen eli for ja while -silmukoihin. Mukana on myös maininta silmukoiden korvaamisesta R:n apply-funktioilla. Lopusta löytyy lisäksi vinkkejä tämän viikon tehtäviin.</p>
<p>Lisäksi tällä viikolla puhutaan R-paketeista.</p>
<div id="for-silmukka" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> For-silmukka</h2>
<p>For-silmukka toistaa koodia ennalta määrättyjen iteraatioiden verran. For-silmukalla voi esimerkiksi käydä läpi data framen tai matriisin sarakkeita tai rivejä, tai vektorin arvoja. For-silmukka iteroi aina jonkin vektorin arvojen yli: for-silmukalle siis annetaan siis vektori arvoja, ja ns. iteraatiomuuttuja, johon tallennetaan vuorotellen yksi alkio annetusta vektorista. Käytännössä tämä näyttää tältä:</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="loops.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">7</span>)) {</span>
<span id="cb431-2"><a href="loops.html#cb431-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb431-3"><a href="loops.html#cb431-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>for-silmukassa määritetään siis ensin iteraatiomuuttuja eli <code>i</code> ja sen saamat arvot eli <code>seq(3, 7)</code> komennolla <code>in</code>. Sen jälkeen hakasulkeiden sisältämä koodi toistetaan jokaiselle <code>i</code>:n arvolle. Tässä tapauksessa yksinkertaisesti tulostetaan muuttujan <code>i</code> arvo.</p>
<p>Usein halutaan kuitenkin käydä läpi jonkin vektorin tai matriisin arvoja. Alla oleva koodi laskee matriisin X rivien summan (tähän voisi myös käyttää valmista funktiota <code>rowSums()</code>). Aluksi alustetaan tyhjä vektori, johon rivien summat tallennetaan. Sen jälkeen käydään läpi matriisin rivit ja tallennetaan rivin summa alussa alustettuun vektoriin.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="loops.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create matrix X</span></span>
<span id="cb432-2"><a href="loops.html#cb432-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb432-3"><a href="loops.html#cb432-3" aria-hidden="true" tabindex="-1"></a>X</span>
<span id="cb432-4"><a href="loops.html#cb432-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-5"><a href="loops.html#cb432-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize vector for row sums</span></span>
<span id="cb432-6"><a href="loops.html#cb432-6" aria-hidden="true" tabindex="-1"></a>row_sums <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(X))</span>
<span id="cb432-7"><a href="loops.html#cb432-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over rows of X</span></span>
<span id="cb432-8"><a href="loops.html#cb432-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(X))) {</span>
<span id="cb432-9"><a href="loops.html#cb432-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign sum of the current row to the vector</span></span>
<span id="cb432-10"><a href="loops.html#cb432-10" aria-hidden="true" tabindex="-1"></a>  row_sums[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(X[i, ])</span>
<span id="cb432-11"><a href="loops.html#cb432-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb432-12"><a href="loops.html#cb432-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-13"><a href="loops.html#cb432-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare results with the result from base R function</span></span>
<span id="cb432-14"><a href="loops.html#cb432-14" aria-hidden="true" tabindex="-1"></a>row_sums</span>
<span id="cb432-15"><a href="loops.html#cb432-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(X)</span></code></pre></div>
<p>For-silmukalla voi myös toteuttaa viime kerralla tehdyn funktion, joka poimii DNA:n emäksistä vain sytosiinit ja guaniinit. Tällä kertaa apufunktiota <code>is_cg()</code> ei tarvitse vektorisoida, koska for-silmukka käy läpi kaikki emäkset. Tämä silmukka voidaan toteuttaa kahdella tavalla. Ensimmäinen tapa on käyttää iteraatiomuuttujana i:tä, joka käy läpi iteraation ykkösestä emäsvektroin pituuteen:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="loops.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function</span></span>
<span id="cb433-2"><a href="loops.html#cb433-2" aria-hidden="true" tabindex="-1"></a>is_cg <span class="ot">&lt;-</span> <span class="cf">function</span>(base) {</span>
<span id="cb433-3"><a href="loops.html#cb433-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (base <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;G&quot;</span>)) {</span>
<span id="cb433-4"><a href="loops.html#cb433-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb433-5"><a href="loops.html#cb433-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb433-6"><a href="loops.html#cb433-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb433-7"><a href="loops.html#cb433-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb433-8"><a href="loops.html#cb433-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb433-9"><a href="loops.html#cb433-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-10"><a href="loops.html#cb433-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Main function</span></span>
<span id="cb433-11"><a href="loops.html#cb433-11" aria-hidden="true" tabindex="-1"></a>pick_cg1 <span class="ot">&lt;-</span> <span class="cf">function</span>(bases) {</span>
<span id="cb433-12"><a href="loops.html#cb433-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize empty vector</span></span>
<span id="cb433-13"><a href="loops.html#cb433-13" aria-hidden="true" tabindex="-1"></a>  only_cg <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb433-14"><a href="loops.html#cb433-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(bases))) {</span>
<span id="cb433-15"><a href="loops.html#cb433-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the current base is C or G, add it to only_cg</span></span>
<span id="cb433-16"><a href="loops.html#cb433-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is_cg</span>(bases[i])) {</span>
<span id="cb433-17"><a href="loops.html#cb433-17" aria-hidden="true" tabindex="-1"></a>      only_cg <span class="ot">&lt;-</span> <span class="fu">c</span>(only_cg, bases[i])</span>
<span id="cb433-18"><a href="loops.html#cb433-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb433-19"><a href="loops.html#cb433-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb433-20"><a href="loops.html#cb433-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb433-21"><a href="loops.html#cb433-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(only_cg)</span>
<span id="cb433-22"><a href="loops.html#cb433-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb433-23"><a href="loops.html#cb433-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-24"><a href="loops.html#cb433-24" aria-hidden="true" tabindex="-1"></a>my_bases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;T&quot;</span>)</span>
<span id="cb433-25"><a href="loops.html#cb433-25" aria-hidden="true" tabindex="-1"></a><span class="fu">pick_cg1</span>(my_bases)</span></code></pre></div>
<p>Toinen vaihtoehto on iteroida suoraan vektorin bases yli, jolloin iteraatiomuuttujaan tallentuu suoraan kyseinen emäs:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="loops.html#cb434-1" aria-hidden="true" tabindex="-1"></a>pick_cg2 <span class="ot">&lt;-</span> <span class="cf">function</span>(bases) {</span>
<span id="cb434-2"><a href="loops.html#cb434-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize empty vector</span></span>
<span id="cb434-3"><a href="loops.html#cb434-3" aria-hidden="true" tabindex="-1"></a>  only_cg <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb434-4"><a href="loops.html#cb434-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (base <span class="cf">in</span> bases) {</span>
<span id="cb434-5"><a href="loops.html#cb434-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the current base is C or G, add it to only_cg</span></span>
<span id="cb434-6"><a href="loops.html#cb434-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is_cg</span>(base)) {</span>
<span id="cb434-7"><a href="loops.html#cb434-7" aria-hidden="true" tabindex="-1"></a>      only_cg <span class="ot">&lt;-</span> <span class="fu">c</span>(only_cg, base)</span>
<span id="cb434-8"><a href="loops.html#cb434-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb434-9"><a href="loops.html#cb434-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb434-10"><a href="loops.html#cb434-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb434-11"><a href="loops.html#cb434-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(only_cg)</span>
<span id="cb434-12"><a href="loops.html#cb434-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb434-13"><a href="loops.html#cb434-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-14"><a href="loops.html#cb434-14" aria-hidden="true" tabindex="-1"></a>my_bases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;T&quot;</span>)</span>
<span id="cb434-15"><a href="loops.html#cb434-15" aria-hidden="true" tabindex="-1"></a><span class="fu">pick_cg2</span>(my_bases)</span></code></pre></div>
<p>Iteraatiomuuttujan voi siis nimetä haluamallaan tavalla, sen ei aina tarvitse olla i. Jos kuitenkin iteraatiomuuttujaan tallennetaan vain yksi luku, suosittelen vahvasti käyttämään i:tä. Tämä on hyvin vakiintunut tapa ohjelmointikielestä ja ohjelmoijasta riippumatta, vaikka muutoin muuttujien nimeämiseen on erilaisia koulukuntia riippuen ohjelmoijan taustasta. Jos taas iteroidaan vektorin nimeltä bases yli, on luonnollinen valinta iteraatiomuuttujan nimeksi base.</p>
<p><img src="files/08-functions/naming.jpg" /></p>
</div>
<div id="while-slimukat" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> While-slimukat</h2>
<p>While-silmukkaa käytetään, kun iteraatioiden määrä ei ole ennalta tiedossa, vaan while-silmukkaa toistetaan niin kauan, kuin tietty ehto on voimassa. Hyvä esimerkki while-loopista on proteiinisynteesi (yksinkertaistettuna): alla oleva funktio käy läpi RNA-molekyylin kodoneita, kunnes löytää aloituskodonin AUG. Sen jälkeen funktio rakentaa aminohappoketjua kodonien perusteella, kunnes vastaan tulee jokin lopetuskodoneista. Oikean proteiinin löytämiseen käytetään Biostrings-paketista löytyvää geneettistä koodia, joka on nimetty vektori, jossa on kodoneita vastaavien aminohappojen kirjainlyhenne, tai lopetuskodonien tapauksessa merkki "*":</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="loops.html#cb435-1" aria-hidden="true" tabindex="-1"></a>rna_code <span class="ot">&lt;-</span> Biostrings<span class="sc">::</span>RNA_GENETIC_CODE</span>
<span id="cb435-2"><a href="loops.html#cb435-2" aria-hidden="true" tabindex="-1"></a>rna_code</span></code></pre></div>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="loops.html#cb436-1" aria-hidden="true" tabindex="-1"></a>prot_synth <span class="ot">&lt;-</span> <span class="cf">function</span>(codons) {</span>
<span id="cb436-2"><a href="loops.html#cb436-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize iterable as the first codon</span></span>
<span id="cb436-3"><a href="loops.html#cb436-3" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb436-4"><a href="loops.html#cb436-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize empty amino acid chain</span></span>
<span id="cb436-5"><a href="loops.html#cb436-5" aria-hidden="true" tabindex="-1"></a>  protein <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb436-6"><a href="loops.html#cb436-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find starting codon</span></span>
<span id="cb436-7"><a href="loops.html#cb436-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (codons[i] <span class="sc">!=</span> <span class="st">&quot;AUG&quot;</span>) {</span>
<span id="cb436-8"><a href="loops.html#cb436-8" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb436-9"><a href="loops.html#cb436-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb436-10"><a href="loops.html#cb436-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># After starting codon, build protein until one of the stop codons is met</span></span>
<span id="cb436-11"><a href="loops.html#cb436-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (rna_code[codons[i]] <span class="sc">!=</span> <span class="st">&quot;*&quot;</span>) {</span>
<span id="cb436-12"><a href="loops.html#cb436-12" aria-hidden="true" tabindex="-1"></a>    protein <span class="ot">&lt;-</span> <span class="fu">c</span>(protein, rna_code[codons[i]])</span>
<span id="cb436-13"><a href="loops.html#cb436-13" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb436-14"><a href="loops.html#cb436-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb436-15"><a href="loops.html#cb436-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(protein)</span>
<span id="cb436-16"><a href="loops.html#cb436-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb436-17"><a href="loops.html#cb436-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-18"><a href="loops.html#cb436-18" aria-hidden="true" tabindex="-1"></a><span class="fu">prot_synth</span>(<span class="at">codons =</span> <span class="fu">c</span>(<span class="st">&quot;UUG&quot;</span>, <span class="st">&quot;GAA&quot;</span>, <span class="st">&quot;AUG&quot;</span>, <span class="st">&quot;UGU&quot;</span>, <span class="st">&quot;AGU&quot;</span>, <span class="st">&quot;AGA&quot;</span>, <span class="st">&quot;UCG&quot;</span>, <span class="st">&quot;UCG&quot;</span>, <span class="st">&quot;UGA&quot;</span>, <span class="st">&quot;GCA&quot;</span>))</span></code></pre></div>
<p>While silmukalle annetaan siis ensin ehto, joka tarkistetaan ennen jokaista iteraatiota. Jos ehto täyttyy, suoritetaan yksi iteraatio, ja tarkistetaan ehto uudestaan. HUOM: while-silmukan sisällä pitää itse kasvattaa iteraatiomuuttujaa, muuten silmukka saattaa jäädä pyörimään ikuisesti!</p>
<p>Käytännössä kaikki for-silmukat voisi korvata while-silmukoilla, mutta for-silmukoiden käyttö on kätevämpää, sillä niissä iteraatiomuuttujaa tarvitse kasvattaa erikseen.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="loops.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A simple for loop</span></span>
<span id="cb437-2"><a href="loops.html#cb437-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>)) {</span>
<span id="cb437-3"><a href="loops.html#cb437-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb437-4"><a href="loops.html#cb437-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb437-5"><a href="loops.html#cb437-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-6"><a href="loops.html#cb437-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The same as above</span></span>
<span id="cb437-7"><a href="loops.html#cb437-7" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb437-8"><a href="loops.html#cb437-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="dv">4</span>) {</span>
<span id="cb437-9"><a href="loops.html#cb437-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb437-10"><a href="loops.html#cb437-10" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb437-11"><a href="loops.html#cb437-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="sisäkkäiset-silmukat-nested-loops" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Sisäkkäiset silmukat (nested loops)</h2>
<p>Silmukoita voi myös olla useampi sisäkkäin. Alla olevassa esimerkissä on taulukko tutkimuksesta, jossa on mitattu eri eliöiden <span class="math inline">\(\beta\)</span>- globiinigeenin ensimmäisen eksonin samankaltaisuutta. Pienempi luku tarkoittaa enemmän samankaltaista geeniä.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Human</th>
<th align="right">Goat</th>
<th align="right">Opossum</th>
<th align="right">Lemur</th>
<th align="right">Mouse</th>
<th align="right">Rabbit</th>
<th align="right">Gorilla</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Human</td>
<td align="right">0.0</td>
<td align="right">4.7</td>
<td align="right">4.6</td>
<td align="right">2.7</td>
<td align="right">3.2</td>
<td align="right">3.2</td>
<td align="right">1.6</td>
</tr>
<tr class="even">
<td align="left">Goat</td>
<td align="right">4.7</td>
<td align="right">0.0</td>
<td align="right">7.2</td>
<td align="right">5.9</td>
<td align="right">7.8</td>
<td align="right">3.7</td>
<td align="right">5.5</td>
</tr>
<tr class="odd">
<td align="left">Opossum</td>
<td align="right">4.6</td>
<td align="right">7.2</td>
<td align="right">0.0</td>
<td align="right">5.3</td>
<td align="right">5.3</td>
<td align="right">6.3</td>
<td align="right">5.7</td>
</tr>
<tr class="even">
<td align="left">Lemur</td>
<td align="right">2.7</td>
<td align="right">5.9</td>
<td align="right">5.3</td>
<td align="right">0.0</td>
<td align="right">4.3</td>
<td align="right">2.7</td>
<td align="right">3.2</td>
</tr>
<tr class="odd">
<td align="left">Mouse</td>
<td align="right">3.2</td>
<td align="right">7.8</td>
<td align="right">5.3</td>
<td align="right">4.3</td>
<td align="right">0.0</td>
<td align="right">6.0</td>
<td align="right">2.9</td>
</tr>
<tr class="even">
<td align="left">Rabbit</td>
<td align="right">3.2</td>
<td align="right">3.7</td>
<td align="right">6.3</td>
<td align="right">2.7</td>
<td align="right">6.0</td>
<td align="right">0.0</td>
<td align="right">3.8</td>
</tr>
<tr class="odd">
<td align="left">Gorilla</td>
<td align="right">1.6</td>
<td align="right">5.5</td>
<td align="right">5.7</td>
<td align="right">3.2</td>
<td align="right">2.9</td>
<td align="right">3.8</td>
<td align="right">0.0</td>
</tr>
</tbody>
</table>
<p>Tämä data on tiedostossa exons.csv, joten luetaan se R:ään:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="loops.html#cb438-1" aria-hidden="true" tabindex="-1"></a>exons <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;exons.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Etsitään seuravaksi kaikki eliöparit, joiden geenien etäisyys on alle 4 ja lisätään parit data frameen, jossa on kaksi saraketta, ja jokainen rivi edustaa yhtä eliöparia. Käytetään tähän kahta sisäkkäistä for-silmukkaa. Toisen silmukan iteraatiomuuttujan nimi on yleensä j, seuraavan k ja niin edelleen. Käydään exons läpi niin, että i on rivin numero, ja j sarakkeen numero, ja etsitään sopivat parit.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="loops.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize empty data frame for the pairs</span></span>
<span id="cb439-2"><a href="loops.html#cb439-2" aria-hidden="true" tabindex="-1"></a>close_pairs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb439-3"><a href="loops.html#cb439-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-4"><a href="loops.html#cb439-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over rows and columns</span></span>
<span id="cb439-5"><a href="loops.html#cb439-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(exons))) {</span>
<span id="cb439-6"><a href="loops.html#cb439-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(exons))) {</span>
<span id="cb439-7"><a href="loops.html#cb439-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if dissimilarity is below 4</span></span>
<span id="cb439-8"><a href="loops.html#cb439-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exons[i, j] <span class="sc">&lt;</span> <span class="dv">4</span>) {</span>
<span id="cb439-9"><a href="loops.html#cb439-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add the pair as a new row to close_pairs</span></span>
<span id="cb439-10"><a href="loops.html#cb439-10" aria-hidden="true" tabindex="-1"></a>      new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species_1 =</span> <span class="fu">rownames</span>(exons)[i],</span>
<span id="cb439-11"><a href="loops.html#cb439-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Species_2 =</span> <span class="fu">colnames</span>(exons)[j])</span>
<span id="cb439-12"><a href="loops.html#cb439-12" aria-hidden="true" tabindex="-1"></a>      close_pairs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(close_pairs,</span>
<span id="cb439-13"><a href="loops.html#cb439-13" aria-hidden="true" tabindex="-1"></a>                           new_row)</span>
<span id="cb439-14"><a href="loops.html#cb439-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb439-15"><a href="loops.html#cb439-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb439-16"><a href="loops.html#cb439-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb439-17"><a href="loops.html#cb439-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-18"><a href="loops.html#cb439-18" aria-hidden="true" tabindex="-1"></a>close_pairs</span></code></pre></div>
<p>Koodimme toimii jo ihan hyvin, mutta tuloksessa on hieman turhaa tavaraa: exons on symmetrinen, joten monet parit on esitetty tuloksessa kahdesti. Tämä voidaan ratkaista muuttamalla toista for-silmukkaa:</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="loops.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize empty data frame for the pairs</span></span>
<span id="cb440-2"><a href="loops.html#cb440-2" aria-hidden="true" tabindex="-1"></a>close_pairs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb440-3"><a href="loops.html#cb440-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-4"><a href="loops.html#cb440-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over rows and columns</span></span>
<span id="cb440-5"><a href="loops.html#cb440-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(exons))) {</span>
<span id="cb440-6"><a href="loops.html#cb440-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only check upper diagonal</span></span>
<span id="cb440-7"><a href="loops.html#cb440-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(i, <span class="fu">ncol</span>(exons))) {</span>
<span id="cb440-8"><a href="loops.html#cb440-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if dissimilarity is below 4</span></span>
<span id="cb440-9"><a href="loops.html#cb440-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exons[i, j] <span class="sc">&lt;</span> <span class="dv">4</span>) {</span>
<span id="cb440-10"><a href="loops.html#cb440-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add the pair as a new row to close_pairs</span></span>
<span id="cb440-11"><a href="loops.html#cb440-11" aria-hidden="true" tabindex="-1"></a>      new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species_1 =</span> <span class="fu">rownames</span>(exons)[i],</span>
<span id="cb440-12"><a href="loops.html#cb440-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Species_2 =</span> <span class="fu">colnames</span>(exons)[j])</span>
<span id="cb440-13"><a href="loops.html#cb440-13" aria-hidden="true" tabindex="-1"></a>      close_pairs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(close_pairs,</span>
<span id="cb440-14"><a href="loops.html#cb440-14" aria-hidden="true" tabindex="-1"></a>                           new_row)</span>
<span id="cb440-15"><a href="loops.html#cb440-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb440-16"><a href="loops.html#cb440-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb440-17"><a href="loops.html#cb440-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb440-18"><a href="loops.html#cb440-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-19"><a href="loops.html#cb440-19" aria-hidden="true" tabindex="-1"></a>close_pairs</span></code></pre></div>
<p>Nyt toisen silmukan läpi käymät j:n arvot riippuvat i:n arvosta. Tämä koodi käy läpi taulukon ylemmän diagonaalin, eli “yläpuolen”. Ensimmäisellä kierroksella j käy läpi arvot 1-7, seuraavalla kierroksella 2-7, sitten 3-7 jne. Vastaavasti voitaisiin myös käydä läpi alempi diagonaali komennolla <code>for(j in seq(1, i)</code>.</p>
<p>Emme kuitenkaan voi olla vieläkään tyytyväisä tulokseen, sillä mukana ovat “parit”, joissa kumpikin laji on sama. Näistä emme luonnollisesti ole kiinnostuneita. Nämä parit voidaan poistaa esimerkiksi `<code>next</code>-komennolla.</p>
</div>
<div id="iterointiin-puuttuminen-next-ja-break" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Iterointiin puuttuminen: next ja break</h2>
<p>Joskus silmukan toimintaan on hyvä puuttua kesken suorituksen. Joskus yksi iteraatio halutaan sivuuttaa kokonaan, toisinaan taas halutaan keskeyttää iteraatio kokonaan. Näihin tarkoituksiin R:ssä on komennot <code>next</code> ja <code>break</code>.</p>
<p>Lisätään edelliseen esimerkkiin toiminto, joka ohittaa diagonaalilla olevat rivit, eli hyppää iteraation yli, jos i ja j ovat yhtä suuret. Käytetään tähän <code>next</code>-komentoa, joka ohjaa ohjelman suoraan seuraavaan iteraatioon:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="loops.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize empty data frame for the pairs</span></span>
<span id="cb441-2"><a href="loops.html#cb441-2" aria-hidden="true" tabindex="-1"></a>close_pairs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb441-3"><a href="loops.html#cb441-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-4"><a href="loops.html#cb441-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over rows and columns</span></span>
<span id="cb441-5"><a href="loops.html#cb441-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(exons))) {</span>
<span id="cb441-6"><a href="loops.html#cb441-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only check upper diagonal</span></span>
<span id="cb441-7"><a href="loops.html#cb441-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(i, <span class="fu">ncol</span>(exons))) {</span>
<span id="cb441-8"><a href="loops.html#cb441-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> j) {</span>
<span id="cb441-9"><a href="loops.html#cb441-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb441-10"><a href="loops.html#cb441-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb441-11"><a href="loops.html#cb441-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if dissimilarity is below 4</span></span>
<span id="cb441-12"><a href="loops.html#cb441-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exons[i, j] <span class="sc">&lt;</span> <span class="dv">4</span>) {</span>
<span id="cb441-13"><a href="loops.html#cb441-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add the pair as a new row to close_pairs</span></span>
<span id="cb441-14"><a href="loops.html#cb441-14" aria-hidden="true" tabindex="-1"></a>      new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species_1 =</span> <span class="fu">rownames</span>(exons)[i],</span>
<span id="cb441-15"><a href="loops.html#cb441-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Species_2 =</span> <span class="fu">colnames</span>(exons)[j])</span>
<span id="cb441-16"><a href="loops.html#cb441-16" aria-hidden="true" tabindex="-1"></a>      close_pairs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(close_pairs,</span>
<span id="cb441-17"><a href="loops.html#cb441-17" aria-hidden="true" tabindex="-1"></a>                           new_row)</span>
<span id="cb441-18"><a href="loops.html#cb441-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb441-19"><a href="loops.html#cb441-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb441-20"><a href="loops.html#cb441-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb441-21"><a href="loops.html#cb441-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-22"><a href="loops.html#cb441-22" aria-hidden="true" tabindex="-1"></a>close_pairs</span></code></pre></div>
<p>Nyt pääsimme eroon kaikista turhista pareista!</p>
<p>Jos haluaisimme kaikkien parien sijaan etsiä vain ensimmäisen parin, jonka geenien etäisyys on alle 3, voisimme käyttää komentoa <code>break</code>, joka keskeyttää silmukan suorittamisen turhaan haluamamme parin löydyttyä.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="loops.html#cb442-1" aria-hidden="true" tabindex="-1"></a>close_pair <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb442-2"><a href="loops.html#cb442-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-3"><a href="loops.html#cb442-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over rows and columns</span></span>
<span id="cb442-4"><a href="loops.html#cb442-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(exons))) {</span>
<span id="cb442-5"><a href="loops.html#cb442-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only check upper diagonal</span></span>
<span id="cb442-6"><a href="loops.html#cb442-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(i, <span class="fu">ncol</span>(exons))) {</span>
<span id="cb442-7"><a href="loops.html#cb442-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> j) {</span>
<span id="cb442-8"><a href="loops.html#cb442-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb442-9"><a href="loops.html#cb442-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb442-10"><a href="loops.html#cb442-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if dissimilarity is below 3</span></span>
<span id="cb442-11"><a href="loops.html#cb442-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exons[i, j] <span class="sc">&lt;</span> <span class="dv">3</span>) {</span>
<span id="cb442-12"><a href="loops.html#cb442-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Assign pair to close_pair and stop search</span></span>
<span id="cb442-13"><a href="loops.html#cb442-13" aria-hidden="true" tabindex="-1"></a>      close_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Species_1 =</span> <span class="fu">rownames</span>(exons)[i],</span>
<span id="cb442-14"><a href="loops.html#cb442-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Species_2 =</span> <span class="fu">colnames</span>(exons)[j])</span>
<span id="cb442-15"><a href="loops.html#cb442-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb442-16"><a href="loops.html#cb442-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb442-17"><a href="loops.html#cb442-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb442-18"><a href="loops.html#cb442-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb442-19"><a href="loops.html#cb442-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-20"><a href="loops.html#cb442-20" aria-hidden="true" tabindex="-1"></a>close_pair</span></code></pre></div>
<p>HUOM: Tämä ei kuitenkaan ole oikea pari: Jos exons data framea käydään läpi rivi kerrallaan, ensimmäinen pari, jonka arvo on alle 3 on Human ja Lemur, ei Mouse ja Gorilla. Mikä siis meni väärin? Kun kyse on näin pienestä aineistosta, voidaan mahdollisia ongelmia tutkia lisäämällä silmukoiden sisään <code>print()</code>-komentoja, jotka kertovat meille silmukan etenemisestä. Lisätään siis edelliseen silmukkaan rivi, joka tulostaa iteraatiomuuttujat i ja j jokaisella iteraatiolla, sekä rivi, joka tulostaa uuden parin, kun sellainen löytyy:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="loops.html#cb443-1" aria-hidden="true" tabindex="-1"></a>close_pair <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb443-2"><a href="loops.html#cb443-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-3"><a href="loops.html#cb443-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over rows and columns</span></span>
<span id="cb443-4"><a href="loops.html#cb443-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(exons))) {</span>
<span id="cb443-5"><a href="loops.html#cb443-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only check upper diagonal</span></span>
<span id="cb443-6"><a href="loops.html#cb443-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(i, <span class="fu">ncol</span>(exons))) {</span>
<span id="cb443-7"><a href="loops.html#cb443-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Monitor loop</span></span>
<span id="cb443-8"><a href="loops.html#cb443-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">c</span>(i, j))</span>
<span id="cb443-9"><a href="loops.html#cb443-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> j) {</span>
<span id="cb443-10"><a href="loops.html#cb443-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb443-11"><a href="loops.html#cb443-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb443-12"><a href="loops.html#cb443-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if dissimilarity is below 3</span></span>
<span id="cb443-13"><a href="loops.html#cb443-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exons[i, j] <span class="sc">&lt;</span> <span class="dv">3</span>) {</span>
<span id="cb443-14"><a href="loops.html#cb443-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Assign pair to close_pair and stop search</span></span>
<span id="cb443-15"><a href="loops.html#cb443-15" aria-hidden="true" tabindex="-1"></a>      close_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Species_1 =</span> <span class="fu">rownames</span>(exons)[i],</span>
<span id="cb443-16"><a href="loops.html#cb443-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Species_2 =</span> <span class="fu">colnames</span>(exons)[j])</span>
<span id="cb443-17"><a href="loops.html#cb443-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(close_pair)</span>
<span id="cb443-18"><a href="loops.html#cb443-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb443-19"><a href="loops.html#cb443-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb443-20"><a href="loops.html#cb443-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb443-21"><a href="loops.html#cb443-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb443-22"><a href="loops.html#cb443-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-23"><a href="loops.html#cb443-23" aria-hidden="true" tabindex="-1"></a>close_pair</span></code></pre></div>
<p>Nyt huomataan, että iteraatio etenee rivillä yksi neljänteen sarakkeeseen asti, ja löytää parin Human-Lemur, aivan kuten pitikin. Jostain syystä ohjelma siirtyy kuitenkin sen jälkeen toiselle riville. Tämä johtuu siitä, että <code>break</code>-komento katkaisee vain yhden for-silmukan kerrallaan. Jos haluamme katkaista myös ulomman silmukan, meidän tulee lisätä ulomman silmukan loppuun tarkastus, joka tarkastaa, onko pari jo löytynyt. Tämä voidaan testata esimerkiksi vektorin close_pairs pituuden avulla. Jos if-rakenteelle antaa pelkän luvun, luku tulkitaan arvoksi TRUE, jos se ei ole nolla.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="loops.html#cb444-1" aria-hidden="true" tabindex="-1"></a>close_pair <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb444-2"><a href="loops.html#cb444-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-3"><a href="loops.html#cb444-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over rows and columns</span></span>
<span id="cb444-4"><a href="loops.html#cb444-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(exons))) {</span>
<span id="cb444-5"><a href="loops.html#cb444-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only check upper diagonal</span></span>
<span id="cb444-6"><a href="loops.html#cb444-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(i, <span class="fu">ncol</span>(exons))) {</span>
<span id="cb444-7"><a href="loops.html#cb444-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> j) {</span>
<span id="cb444-8"><a href="loops.html#cb444-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb444-9"><a href="loops.html#cb444-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb444-10"><a href="loops.html#cb444-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if dissimilarity is below 3</span></span>
<span id="cb444-11"><a href="loops.html#cb444-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exons[i, j] <span class="sc">&lt;</span> <span class="dv">3</span>) {</span>
<span id="cb444-12"><a href="loops.html#cb444-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Assign pair to close_pair and stop search</span></span>
<span id="cb444-13"><a href="loops.html#cb444-13" aria-hidden="true" tabindex="-1"></a>      close_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Species_1 =</span> <span class="fu">rownames</span>(exons)[i],</span>
<span id="cb444-14"><a href="loops.html#cb444-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Species_2 =</span> <span class="fu">colnames</span>(exons)[j])</span>
<span id="cb444-15"><a href="loops.html#cb444-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb444-16"><a href="loops.html#cb444-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb444-17"><a href="loops.html#cb444-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb444-18"><a href="loops.html#cb444-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Stop iterating if the pair has been found</span></span>
<span id="cb444-19"><a href="loops.html#cb444-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(close_pair)) {</span>
<span id="cb444-20"><a href="loops.html#cb444-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb444-21"><a href="loops.html#cb444-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb444-22"><a href="loops.html#cb444-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb444-23"><a href="loops.html#cb444-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-24"><a href="loops.html#cb444-24" aria-hidden="true" tabindex="-1"></a>close_pair</span></code></pre></div>
<p>Nyt koodimme toimii, kuten pitääkin!</p>
</div>
<div id="apply-funktiot" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> Apply-funktiot</h2>
<p>R:ssä käytetään silmukoiden lisäksi <code>apply()</code>-funktioperheen funktioita, joilla voi käydä läpi data frameja, matriiseja tai vektoreita ilman silmukoita. Joissain tapauksissa <code>apply</code>-funktiot ovat myös nopeampia kuin silmukat. Tästä syystä niitä näkee käytettävän paljon, ja varsinkin kokeneemmat R-ohjelmoijat käyttävät niitä paljon. Tällä kurssilla näitä funktioita ei kuitenkaan tarvita. Tässä on annettu muutamia esimerkkejä, voit lukea lisää esimerkiksi <a href="https://www.datacamp.com/community/tutorials/r-tutorial-apply-family">DataCampin tutoriaalista</a></p>
<p><code>apply()</code> käy läpi matriisin/data framen rivit tai sarakkeet, ja ajaa jonkin funktion jokaiselle riville tai sarakkeelle. Alla oleva esimerkki normalisoi kaikki R:n sisäisen datan trees sarakkeet autoscaling-menetelmällä, jossa sarakkeen arvoista vähennetään sarakkeen keskiarvo ja tulos jaetaan sarakkeen keskihajonnalla. Normalisoinnin tarkoitus on, että kaikkien sarakkeiden keskiarvoksi saadaan 0, ja kaikilla on sama varianssi (ja keskihajonta) 1.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="loops.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trees)</span>
<span id="cb445-2"><a href="loops.html#cb445-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-3"><a href="loops.html#cb445-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb445-4"><a href="loops.html#cb445-4" aria-hidden="true" tabindex="-1"></a>  scaled <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x)) <span class="sc">/</span> <span class="fu">sd</span>(x)</span>
<span id="cb445-5"><a href="loops.html#cb445-5" aria-hidden="true" tabindex="-1"></a>  scaled</span>
<span id="cb445-6"><a href="loops.html#cb445-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb445-7"><a href="loops.html#cb445-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-8"><a href="loops.html#cb445-8" aria-hidden="true" tabindex="-1"></a>scaled_trees <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="at">X =</span> trees, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> scaler)</span>
<span id="cb445-9"><a href="loops.html#cb445-9" aria-hidden="true" tabindex="-1"></a>scaled_trees <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scaled_trees)</span>
<span id="cb445-10"><a href="loops.html#cb445-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scaled_trees)</span></code></pre></div>
<p>MARGIN-argumentilla määritetään, käydäänkö läpi rivit vai sarakkeet (1 = rivit, 2 = sarakkeet). HUOM: <code>apply</code> palauttaa aina matriisin tai vektorin. Jos tulos halutaan muuntaa takaisin data frameksi, täytyy se tehdä erikseen.</p>
<p>Tarkistetaan tulos laskemalla sarakkeiden keskiarvot ja varianssit. Tämä voidaan tehdä <code>apply</code>-funktiolla, tai käyttää <code>sapply</code>-funktiota, joka käy automaattisesti data framen sarakkeet, ja ajaa saman funktion sarakkeille kuten <code>apply</code>. <code>sapply</code>-komennon funktion on pakko palauttaa vain yksi arvo, sillä <code>sapply</code> kokoaa automaattisesti tuloksensa vektoriin.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="loops.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(scaled_trees, <span class="dv">2</span>, mean)</span>
<span id="cb446-2"><a href="loops.html#cb446-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(scaled_trees, var)</span></code></pre></div>
<p>Huomaa, että sarakkeiden keskiarvot eivät ole tismalleen 0. Tämä johtuu R:n rajallisesta numeerisesta tarkkuudesta. Käytännössä itseisarvoltaan tätä luokkaa olevat arvot ovat nollia.</p>
</div>
<div id="vinkkejä-tehtäviin" class="section level2" number="11.6">
<h2><span class="header-section-number">11.6</span> Vinkkejä tehtäviin</h2>
<p>Tämän viikon tehtävissä pitää muokata funktioita, jotka ovat erillisissä tiedostoissa. Jotta tehtävän palautus onnistuu, funktio pitää muokata tässä tiedostossa. Funktio kannattaa kuitenkin kopioida talteen toiseen tiedostoon, sillä tehtävän palauttaminen pyyhkii tiedoston.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ifelse.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-ohjelmoinnin perusteet.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
