<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kappale 6 Lineaariset mallit ja tilastolliset jakaumat | R-ohjelmoinnin perusteet</title>
  <meta name="description" content="This repository contains materials used in an introductory level R course at university of Eastern Finland." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Kappale 6 Lineaariset mallit ja tilastolliset jakaumat | R-ohjelmoinnin perusteet" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This repository contains materials used in an introductory level R course at university of Eastern Finland." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kappale 6 Lineaariset mallit ja tilastolliset jakaumat | R-ohjelmoinnin perusteet" />
  
  <meta name="twitter:description" content="This repository contains materials used in an introductory level R course at university of Eastern Finland." />
  

<meta name="author" content="Anton Klåvus (2020), converted to bookdown by Juho Kopra (2021)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting.html"/>
<link rel="next" href="functions.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-ohjelmoinnin perusteet</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html"><i class="fa fa-check"></i>R-kurssi</a>
<ul>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html#sisällysluettelo"><i class="fa fa-check"></i>Sisällysluettelo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html"><i class="fa fa-check"></i>Alkuvalmistelut</a>
<ul>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rn-ja-rstudion-asentaminen-omalle-tietokoneelle"><i class="fa fa-check"></i>R:n ja RStudion asentaminen omalle tietokoneelle</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudion-asennus-yliopiston-koneelle"><i class="fa fa-check"></i>RStudion asennus yliopiston koneelle</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudion-käyttö"><i class="fa fa-check"></i>RStudion käyttö</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rcourse-paketin-asentaminen"><i class="fa fa-check"></i>Rcourse-paketin asentaminen</a>
<ul>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#r-paketit"><i class="fa fa-check"></i>R-paketit</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#asentaminen"><i class="fa fa-check"></i>Asentaminen</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#opiskelu-ja-tenttiminen-rcourse-paketin-avulla"><i class="fa fa-check"></i>Opiskelu ja tenttiminen Rcourse-paketin avulla</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#tehtävien-tallentaminen-skripteihin-rstudiolla"><i class="fa fa-check"></i>Tehtävien tallentaminen skripteihin RStudiolla</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Johdanto</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what_R"><i class="fa fa-check"></i><b>1.1</b> Mikä R on ja mitä sillä tehdään?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html"><i class="fa fa-check"></i><b>2</b> Muuttujat ja vektorit</a>
<ul>
<li class="chapter" data-level="2.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#muuttujat-variables"><i class="fa fa-check"></i><b>2.1</b> Muuttujat (Variables)</a></li>
<li class="chapter" data-level="2.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#kommentit"><i class="fa fa-check"></i><b>2.2</b> Kommentit</a></li>
<li class="chapter" data-level="2.3" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#vektorit-vectors"><i class="fa fa-check"></i><b>2.3</b> Vektorit (Vectors)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#ei-numeeriset-vektorit"><i class="fa fa-check"></i><b>2.3.1</b> Ei-numeeriset vektorit</a></li>
<li class="chapter" data-level="2.3.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#vektorien-indeksointi-ja-leikkely"><i class="fa fa-check"></i><b>2.3.2</b> Vektorien indeksointi ja leikkely</a></li>
<li class="chapter" data-level="2.3.3" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#puuttuvat-arvot"><i class="fa fa-check"></i><b>2.3.3</b> Puuttuvat arvot</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#extra"><i class="fa fa-check"></i><b>2.4</b> Extra: Alkeistietotyypit ja puuttuvat arvot</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>3</b> Tietotyypit</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-types.html"><a href="data-types.html#data-frame"><i class="fa fa-check"></i><b>3.1</b> Data frame</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-types.html"><a href="data-types.html#data-framen-käsittely"><i class="fa fa-check"></i><b>3.1.1</b> Data framen käsittely</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-types.html"><a href="data-types.html#matriisi"><i class="fa fa-check"></i><b>3.2</b> Matriisi</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-types.html"><a href="data-types.html#matriisin-luominen"><i class="fa fa-check"></i><b>3.2.1</b> Matriisin luominen</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-types.html"><a href="data-types.html#matriisin-koko"><i class="fa fa-check"></i><b>3.2.2</b> Matriisin koko</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-types.html"><a href="data-types.html#matriisin-indeksointi"><i class="fa fa-check"></i><b>3.2.3</b> Matriisin indeksointi</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-types.html"><a href="data-types.html#matriisien-rakentaminen-vektoreista"><i class="fa fa-check"></i><b>3.2.4</b> Matriisien rakentaminen vektoreista</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-types.html"><a href="data-types.html#rivien-ja-sarakkeiden-nimeäminen"><i class="fa fa-check"></i><b>3.2.5</b> Rivien ja sarakkeiden nimeäminen</a></li>
<li class="chapter" data-level="3.2.6" data-path="data-types.html"><a href="data-types.html#matriiseilla-laskeminen"><i class="fa fa-check"></i><b>3.2.6</b> Matriiseilla laskeminen</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-types.html"><a href="data-types.html#tietotyyppien-tarkastelu"><i class="fa fa-check"></i><b>3.3</b> Tietotyyppien tarkastelu</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-types.html"><a href="data-types.html#view"><i class="fa fa-check"></i><b>3.3.1</b> View()</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-types.html"><a href="data-types.html#str"><i class="fa fa-check"></i><b>3.3.2</b> str()</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-types.html"><a href="data-types.html#head"><i class="fa fa-check"></i><b>3.3.3</b> head()</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-types.html"><a href="data-types.html#extra-taulukko-ja-lista"><i class="fa fa-check"></i><b>3.4</b> Extra: Taulukko ja lista</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-types.html"><a href="data-types.html#taulukko"><i class="fa fa-check"></i><b>3.4.1</b> Taulukko</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-types.html"><a href="data-types.html#lista"><i class="fa fa-check"></i><b>3.4.2</b> Lista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>4</b> Datan sisään lukeminen</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reading-data.html"><a href="reading-data.html#tekstitiedostot"><i class="fa fa-check"></i><b>4.1</b> Tekstitiedostot</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="reading-data.html"><a href="reading-data.html#read.table"><i class="fa fa-check"></i><b>4.1.1</b> read.table()</a></li>
<li class="chapter" data-level="4.1.2" data-path="reading-data.html"><a href="reading-data.html#read.csv"><i class="fa fa-check"></i><b>4.1.2</b> read.csv()</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="reading-data.html"><a href="reading-data.html#data-framen-rakenteen-tutkiminen"><i class="fa fa-check"></i><b>4.2</b> Data framen rakenteen tutkiminen</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reading-data.html"><a href="reading-data.html#rn-sisäänrakennetut-datasetit"><i class="fa fa-check"></i><b>4.2.1</b> R:n sisäänrakennetut datasetit</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reading-data.html"><a href="reading-data.html#muut-tiedostot"><i class="fa fa-check"></i><b>4.3</b> Muut tiedostot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="reading-data.html"><a href="reading-data.html#excel"><i class="fa fa-check"></i><b>4.3.1</b> Excel</a></li>
<li class="chapter" data-level="4.3.2" data-path="reading-data.html"><a href="reading-data.html#spss"><i class="fa fa-check"></i><b>4.3.2</b> SPSS</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="reading-data.html"><a href="reading-data.html#vinkkejä-tehtäviin"><i class="fa fa-check"></i><b>4.4</b> Vinkkejä tehtäviin</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>5</b> Kuvaajien piirtäminen</a>
<ul>
<li class="chapter" data-level="5.1" data-path="plotting.html"><a href="plotting.html#korkean-tason-piirtofunktiot"><i class="fa fa-check"></i><b>5.1</b> Korkean tason piirtofunktiot</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="plotting.html"><a href="plotting.html#plot"><i class="fa fa-check"></i><b>5.1.1</b> plot()</a></li>
<li class="chapter" data-level="5.1.2" data-path="plotting.html"><a href="plotting.html#muut-korkean-tason-funktiot"><i class="fa fa-check"></i><b>5.1.2</b> Muut korkean tason funktiot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="plotting.html"><a href="plotting.html#alemman-tason-grafiikkatoiminnot"><i class="fa fa-check"></i><b>5.2</b> Alemman tason grafiikkatoiminnot</a></li>
<li class="chapter" data-level="5.3" data-path="plotting.html"><a href="plotting.html#kuvaajien-piirtäminen-käytännössä"><i class="fa fa-check"></i><b>5.3</b> Kuvaajien piirtäminen käytännössä</a></li>
<li class="chapter" data-level="5.4" data-path="plotting.html"><a href="plotting.html#tämän-viikon-tehtävä"><i class="fa fa-check"></i><b>5.4</b> Tämän viikon tehtävä</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>6</b> Lineaariset mallit ja tilastolliset jakaumat</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistics.html"><a href="statistics.html#factor-vektorit"><i class="fa fa-check"></i><b>6.1</b> Factor-vektorit</a></li>
<li class="chapter" data-level="6.2" data-path="statistics.html"><a href="statistics.html#linear_models"><i class="fa fa-check"></i><b>6.2</b> Lineaariset mallit</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="statistics.html"><a href="statistics.html#teoria"><i class="fa fa-check"></i><b>6.2.1</b> Teoria</a></li>
<li class="chapter" data-level="6.2.2" data-path="statistics.html"><a href="statistics.html#esimerkki"><i class="fa fa-check"></i><b>6.2.2</b> Esimerkki</a></li>
<li class="chapter" data-level="6.2.3" data-path="statistics.html"><a href="statistics.html#tarkempia-tietoja-mallista"><i class="fa fa-check"></i><b>6.2.3</b> Tarkempia tietoja mallista</a></li>
<li class="chapter" data-level="6.2.4" data-path="statistics.html"><a href="statistics.html#ennustaminen"><i class="fa fa-check"></i><b>6.2.4</b> Ennustaminen</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="statistics.html"><a href="statistics.html#korrelaatio"><i class="fa fa-check"></i><b>6.3</b> Korrelaatio</a></li>
<li class="chapter" data-level="6.4" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>6.4</b> Todennäköisyysjakaumat R:ssä</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="statistics.html"><a href="statistics.html#esimerkki-normaalijakauma"><i class="fa fa-check"></i><b>6.4.1</b> Esimerkki: normaalijakauma</a></li>
<li class="chapter" data-level="6.4.2" data-path="statistics.html"><a href="statistics.html#muita-jakaumia"><i class="fa fa-check"></i><b>6.4.2</b> Muita jakaumia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>7</b> Funktiot</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functions.html"><a href="functions.html#funktion-käsite"><i class="fa fa-check"></i><b>7.1</b> Funktion käsite</a></li>
<li class="chapter" data-level="7.2" data-path="functions.html"><a href="functions.html#r-funktiot"><i class="fa fa-check"></i><b>7.2</b> R-funktiot</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="functions.html"><a href="functions.html#funktioiden-määrittely"><i class="fa fa-check"></i><b>7.2.1</b> Funktioiden määrittely</a></li>
<li class="chapter" data-level="7.2.2" data-path="functions.html"><a href="functions.html#argumentit-ja-funktion-kutsuminen"><i class="fa fa-check"></i><b>7.2.2</b> Argumentit ja funktion kutsuminen</a></li>
<li class="chapter" data-level="7.2.3" data-path="functions.html"><a href="functions.html#funktio-ilman-argumentteja"><i class="fa fa-check"></i><b>7.2.3</b> Funktio ilman argumentteja</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="functions.html"><a href="functions.html#arvojen-palautus"><i class="fa fa-check"></i><b>7.3</b> Arvojen palautus</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="functions.html"><a href="functions.html#usean-arvon-palautus"><i class="fa fa-check"></i><b>7.3.1</b> Usean arvon palautus</a></li>
<li class="chapter" data-level="7.3.2" data-path="functions.html"><a href="functions.html#palautus-ilman-return-käskyä"><i class="fa fa-check"></i><b>7.3.2</b> Palautus ilman return-käskyä</a></li>
<li class="chapter" data-level="7.3.3" data-path="functions.html"><a href="functions.html#funktio-ilman-tulosta"><i class="fa fa-check"></i><b>7.3.3</b> Funktio ilman tulosta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ifelse.html"><a href="ifelse.html"><i class="fa fa-check"></i><b>8</b> Ehtorakenteet</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ifelse.html"><a href="ifelse.html#loogiset-operaattorit"><i class="fa fa-check"></i><b>8.1</b> Loogiset operaattorit</a></li>
<li class="chapter" data-level="8.2" data-path="ifelse.html"><a href="ifelse.html#ehtorakenteet"><i class="fa fa-check"></i><b>8.2</b> Ehtorakenteet</a></li>
<li class="chapter" data-level="8.3" data-path="ifelse.html"><a href="ifelse.html#alkioiden-poimiminen-vektorista-tietyh-ehdon-perusteella"><i class="fa fa-check"></i><b>8.3</b> Alkioiden poimiminen vektorista tietyh ehdon perusteella</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>9</b> Toistorakenteet (loops)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="loops.html"><a href="loops.html#for-silmukka"><i class="fa fa-check"></i><b>9.1</b> For-silmukka</a></li>
<li class="chapter" data-level="9.2" data-path="loops.html"><a href="loops.html#while-slimukat"><i class="fa fa-check"></i><b>9.2</b> While-slimukat</a></li>
<li class="chapter" data-level="9.3" data-path="loops.html"><a href="loops.html#sisäkkäiset-silmukat-nested-loops"><i class="fa fa-check"></i><b>9.3</b> Sisäkkäiset silmukat (nested loops)</a></li>
<li class="chapter" data-level="9.4" data-path="loops.html"><a href="loops.html#iterointiin-puuttuminen-next-ja-break"><i class="fa fa-check"></i><b>9.4</b> Iterointiin puuttuminen: next ja break</a></li>
<li class="chapter" data-level="9.5" data-path="loops.html"><a href="loops.html#apply-funktiot"><i class="fa fa-check"></i><b>9.5</b> Apply-funktiot</a></li>
<li class="chapter" data-level="9.6" data-path="loops.html"><a href="loops.html#vinkkejä-tehtäviin-1"><i class="fa fa-check"></i><b>9.6</b> Vinkkejä tehtäviin</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Julkaistu bookdownilla.</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-ohjelmoinnin perusteet</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1" number="6">
<h1><span class="header-section-number">Kappale 6</span> Lineaariset mallit ja tilastolliset jakaumat</h1>
<p>Tässä osiossa tutustutaan lineaarisiin malleihin ja yleisimpien jakaumien käyttöön R:ssä. Jos konseptit eivät ole tilastotieteen kursseilta tuttuja, ei hätää: tämä dokumentti sisältää lyhyet selitykset tärkeimmistä konsepteista, ja loput selitetään varsinaisilla tilastotieteen kursseilla.</p>
<p>Ennen kuin puhutaan tilastollisten testien tekemisestä R:llä, on hyvä tutustua factor-luokan vektoreihin</p>
<div id="factor-vektorit" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Factor-vektorit</h2>
<p>R:ssä on aiemmin nähtyjen numeric, character ja logical-vektorien lisäksi muitakin vektoriluokkia, tärkeimpänä näistä factor. Factor-vektoreihin tallennetaan kategorisia muuttujia, kuten tutkimuksessa määrättyjä ryhmiä, aikapisteitä tms. Luodaan esimerkiksi factor-vektori, jossa on kuvitteellisen lääketutkimuksen osallistujien ryhmätiedot:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="statistics.html#cb281-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;drug1&quot;</span>, <span class="st">&quot;drug2&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;drug1&quot;</span>, <span class="st">&quot;control&quot;</span>,</span>
<span id="cb281-2"><a href="statistics.html#cb281-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;drug2&quot;</span>, <span class="st">&quot;drug2&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;drug1&quot;</span>))</span>
<span id="cb281-3"><a href="statistics.html#cb281-3" aria-hidden="true" tabindex="-1"></a>groups</span></code></pre></div>
<pre><code>##  [1] drug1   drug2   control drug1   control drug2   drug2   control control
## [10] drug1  
## Levels: control drug1 drug2</code></pre>
<p>Factoreita voi luoda muista vektoreista funktioilla <code>factor</code> tai <code>as.factor()</code>. <code>as.factor</code> muuntaa vektorin automaattisesti ja nopeasti factoriksi, ja säilyttää myös jo valmiiksi factor-luokan vektorien tasojen järjestyksen (tästä lisää pian).</p>
<p>Kuten tulosteesta nähdään, factor-vektorin tulostus tulostaa factorin alkiot (HUOM: ei hipsuja) sekä factorin tasot. Factorit ovat pinnan alla kokonaisluku- eli integer-vektoreita, joissa on päällä “kerros”, joka määrittää factorin tasot. Edellä nähty vektori groups näyttää siis tältä:</p>
<p><img src="files/05-statistics/factor.png" /></p>
<p>Factorien tasoille annetaan siis lukuarvot ykkösestä eteenpäin. Oletuksena ensimmäinen taso eli taso 1 on aakkosissa ensimmäinen arvo, tai pienin lukuarvo jos factori tehdään numeerisista muuttujista. Lukuarvot saa näkyville muuntamalla factorin numeeriseksi vektoriksi:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="statistics.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(groups)</span></code></pre></div>
<pre><code>##  [1] 2 3 1 2 1 3 3 1 1 2</code></pre>
<p>Tasojen järjestyksen voi myös päättää itse. Tämä on tärkeää, sillä kuten pian nähdään, factorin ensimmäinen taso on monissa tilastollisissa testeissä ns. referenssitaso, johon muita tasoja verrataan. Usein esiintyvä tapaus ovat tutkimukset, joissa on ryhmät nimeltä case ja control. Koska case on aakkosissa ennen controllia, R käyttää oletuksen case-ryhmää referenssitasona, ja testaa miten control-ryhmä poikkeaa tästä tasosta, vaikka haluaisimme päinvastaisen tuloksen. Tasot voi itse määrittää näin:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="statistics.html#cb285-1" aria-hidden="true" tabindex="-1"></a>study_groups <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;case&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;case&quot;</span>, <span class="st">&quot;case&quot;</span>),</span>
<span id="cb285-2"><a href="statistics.html#cb285-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;case&quot;</span>))</span>
<span id="cb285-3"><a href="statistics.html#cb285-3" aria-hidden="true" tabindex="-1"></a>study_groups</span></code></pre></div>
<pre><code>## [1] case    control control case    case   
## Levels: control case</code></pre>
<p>Nyt tasot ovat oikeassa järjestyksessä!</p>
<p>Kuten aiemmin mainittiin, factoreita voi tehdä myös numeerisista vektoreista. HUOM: muista, että <code>as.numeric()</code> palauttaa factorin kokonaislukuarvot, ei alkuperäisiä lukuja. Alkuperäiset luvut saa käyttämällä ensin <code>as.character</code>-funktiota, joka muuttaa factorin tasot merkkijonovektoriksi.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="statistics.html#cb287-1" aria-hidden="true" tabindex="-1"></a>time_points <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">5</span>))</span>
<span id="cb287-2"><a href="statistics.html#cb287-2" aria-hidden="true" tabindex="-1"></a>time_points</span></code></pre></div>
<pre><code>## [1] 0 0 1 1 5 5 1 0 5
## Levels: 0 1 5</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="statistics.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probably not what you expect</span></span>
<span id="cb289-2"><a href="statistics.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(time_points)</span></code></pre></div>
<pre><code>## [1] 1 1 2 2 3 3 2 1 3</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="statistics.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First to character, then to numeric</span></span>
<span id="cb291-2"><a href="statistics.html#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">as.character</span>(time_points))</span></code></pre></div>
<pre><code>## [1] 0 0 1 1 5 5 1 0 5</code></pre>
</div>
<div id="linear_models" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Lineaariset mallit</h2>
<p>Lineaarisessa mallissa eli lineaarisessa regressiossa tavoite on arvioida vastemuuttujan lineaarista riippuvuutta selittävistä muuttujista. Käytetään esimerkkinä R:n sisäistä datasettiä cars, jossa on kirjattu 50 auton nopeus ja pysähtymismatka. Tavoitteena on tutkia, miten auton pysähtymismatka riippuu auton nopeudesta.</p>
<div id="teoria" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Teoria</h3>
<p>Yksinkertaisin mahdollinen lineaarinen regressiomalli näyttää tältä:</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x_1 + \epsilon\]</span></p>
<ul>
<li><span class="math inline">\(y\)</span> on vastemuuttuja, tässä auton pysähtymismatka</li>
<li><span class="math inline">\(\beta_0\)</span> on ns. vakiotermi eli käyrän y-akselin leikkauskohta</li>
<li><span class="math inline">\(\beta_1\)</span> on selittävän muuttujan eli auton nopeuden regressiokerroin</li>
<li><span class="math inline">\(x_1\)</span> on selittävä muuttuja eli auton nopeus</li>
<li><span class="math inline">\(\epsilon\)</span> on residuaalitermi (virhetermi)</li>
</ul>
<p>Mallissa siis oletetaan, että auton pysähtymismatka nopeudella 0 km/h on <span class="math inline">\(\beta_0\)</span> ja kasvaa <span class="math inline">\(\beta_1\)</span> verran, kun nopeus kasvaa 1 km/h. Lisäksi mukana on virhetermi, joka selittää satunnaisen vaihtelun tuloksissa lineaarisen käyrän ympärillä.</p>
<p>Jos malliin halutaan lisätä selittäviä muuttujia, kuten auton jarrujen kunto (<span class="math inline">\(x_2\)</span>) tai sääolosuhteet (<span class="math inline">\(x_3\)</span>), malli näyttää tältä:</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + ... + \epsilon\]</span></p>
<p>Eli jokaiselle selittävälle muuttujalle annetaan oma regressiokerroin.</p>
</div>
<div id="esimerkki" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Esimerkki</h3>
<p>Muutetaan ensin cars-datasetin muuttujat meille tuttuihin yksikköihin, ja piirretään hajontakuvio havainnoista:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="statistics.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change units</span></span>
<span id="cb293-2"><a href="statistics.html#cb293-2" aria-hidden="true" tabindex="-1"></a>cars<span class="sc">$</span>speed <span class="ot">&lt;-</span> cars<span class="sc">$</span>speed <span class="sc">*</span> <span class="fl">1.60934</span></span>
<span id="cb293-3"><a href="statistics.html#cb293-3" aria-hidden="true" tabindex="-1"></a>cars<span class="sc">$</span>dist <span class="ot">&lt;-</span> cars<span class="sc">$</span>dist <span class="sc">*</span> <span class="fl">0.0254</span></span>
<span id="cb293-4"><a href="statistics.html#cb293-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb293-5"><a href="statistics.html#cb293-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cars<span class="sc">$</span>speed, cars<span class="sc">$</span>dist,</span>
<span id="cb293-6"><a href="statistics.html#cb293-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Speed (km/h)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Distance (m)&quot;</span>,</span>
<span id="cb293-7"><a href="statistics.html#cb293-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Stopping distances of cars&quot;</span>) </span></code></pre></div>
<p><img src="R-ohjelmoinnin-perusteet_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
<p>Autojen välillä on eroja, mutta kuten voi odottaa, suuremmilla nopeuksilla auton pysähtymismatka kasvaa. Käytetään seuraavaksi R:n funktiota <code>lm()</code>, jolla voidaan sovittaa dataan lineaarinen malli:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="statistics.html#cb294-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data =</span> cars)</span>
<span id="cb294-2"><a href="statistics.html#cb294-2" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>## (Intercept)       speed 
## -0.44650901  0.06206469</code></pre>
<p><code>lm()</code>-funktiolle annetaan ensimmäiseksi argumentiksi lineaarisen mallin kaava, jossa <code>~</code> korvaa yllä nähdyn yhtäkuin-merkin. HUOM: vakiotermi on automaattisesti mukana, eli sitä ei tarvitse kirjata erikseen. Lisäksi täytyy antaa data frame, josta kaavassa näkyvät muuttujat löytyvät.</p>
<p>Lineaarisesta mallista saadaan irti paljon tietoa, tärkeimpinä mallin kertoimet (coefficients). Yllä olevista kertoimista voidaan päätellä, että kun auton nopeus nousee 1 km/h, autojen pysähtymismatka kasvaa noin 0.06 m ja odotettu kasvukäyrä leikkaa y-akselin -0.4 m kohdalla. Voimme piirtää tämän käyrän kuvaajaan <code>abline()</code>-funktion avulla, antamalla sille mallin kertoimet:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="statistics.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cars<span class="sc">$</span>speed, cars<span class="sc">$</span>dist,</span>
<span id="cb296-2"><a href="statistics.html#cb296-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Speed (km/h)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Distance (m)&quot;</span>,</span>
<span id="cb296-3"><a href="statistics.html#cb296-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Stopping distances of cars&quot;</span>)</span>
<span id="cb296-4"><a href="statistics.html#cb296-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> model<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">b =</span> model<span class="sc">$</span>coefficients[<span class="dv">2</span>])</span></code></pre></div>
<p><img src="R-ohjelmoinnin-perusteet_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
<div id="tarkempia-tietoja-mallista" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Tarkempia tietoja mallista</h3>
<p>Muihin mallin tietoihin pääsee käsiksi <code>summary</code>-funktion avulla, joko tulostamalla tuloksen konsoliin, tai sijoittamalla sen muuttujaan, josta voi etsiä mallin tietoja.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="statistics.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary information</span></span>
<span id="cb297-2"><a href="statistics.html#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dist ~ speed, data = cars)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.73835 -0.24194 -0.05771  0.23405  1.09731 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.446509   0.171664  -2.601   0.0123 *  
## speed        0.062065   0.006558   9.464 1.49e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3906 on 48 degrees of freedom
## Multiple R-squared:  0.6511, Adjusted R-squared:  0.6438 
## F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="statistics.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save summary and access specific information</span></span>
<span id="cb299-2"><a href="statistics.html#cb299-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb299-3"><a href="statistics.html#cb299-3" aria-hidden="true" tabindex="-1"></a>s<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.6510794</code></pre>
<p><code>summary()</code> kertoo mm. kertoimien arvojen lisäksi niiden saamat p-arvot kohdassa (Pr &gt; |t|), sekä mallin selitysasteen (merkintätapa johtuu siitä, että p-arvot tulevat t-testeistä). Tässä tapauksessa muuttujan speed p-arvo on hyvin pieni, joten voimme todeta suurella varmuudella, että autojen pysähtymismatka riippuu (lineaarisesti) auton nopeudesta. R<sup>2</sup> eli R-squared kertoo, kuinka suuren osuuden pysähtymismatkojen varianssista auton nopeus selittää.</p>
</div>
<div id="ennustaminen" class="section level3" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Ennustaminen</h3>
<p>Kun lineaarinen malli on luotu, sen perusteella voidaan myös ennustaa arvoja uusille havainnoille. Tämä tapahtuu <code>predict()</code>-komennolla, jolle annetaan malli, sekä uuden datan sisältävä data frame. Ennustetaan edellisen mallin perusteella pysähtymismatka autolle neljällä uudella nopeudella ja lisätään ne edelliseen kuvaajaan punaisilla rukseilla:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="statistics.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with new speed values</span></span>
<span id="cb301-2"><a href="statistics.html#cb301-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">speed =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">15</span>, <span class="dv">38</span>))</span>
<span id="cb301-3"><a href="statistics.html#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dist column by predicting from linear model</span></span>
<span id="cb301-4"><a href="statistics.html#cb301-4" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> new_data)</span>
<span id="cb301-5"><a href="statistics.html#cb301-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-6"><a href="statistics.html#cb301-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add points to previous plot</span></span>
<span id="cb301-7"><a href="statistics.html#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cars<span class="sc">$</span>speed, cars<span class="sc">$</span>dist,</span>
<span id="cb301-8"><a href="statistics.html#cb301-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Speed (km/h)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Distance (m)&quot;</span>,</span>
<span id="cb301-9"><a href="statistics.html#cb301-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Stopping distances of cars&quot;</span>)</span>
<span id="cb301-10"><a href="statistics.html#cb301-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> model<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">b =</span> model<span class="sc">$</span>coefficients[<span class="dv">2</span>])</span>
<span id="cb301-11"><a href="statistics.html#cb301-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(new_data<span class="sc">$</span>speed, new_data<span class="sc">$</span>dist, <span class="at">pch =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="R-ohjelmoinnin-perusteet_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<p>Kuten huomataan, ennustetut arvot ovat täsmälleen käyrän päällä.</p>
</div>
</div>
<div id="korrelaatio" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Korrelaatio</h2>
<p>Korrelaatio on lineaarisen regression ohella tapa mitata kahden muuttujan välistä riippuvuutta. Korrelaatiolle on monia erilaisia mittareita, joista yleisimmät ovat Pearsonin korrelaatiokerroin, joka mittaa kahden muuttujan välistä lineaarista riippuvuutta ja Spearmanin järjestyskorrelaatiokerroin, joka mittaa kahden muuttujan välistä riippuvuutta ilman lineaarisuusoletusta. HUOM: korrelaatio ei ota kantaa siihen, kuinka vahva riippuvuus on (käyrän jyrkkyys), vaan pelkästään siihen, kuinka systemaattinen riippuvuus on. Kummatkin korrelaatiokertoimet saavat arvoja väliltä [-1, 1], jossa -1 on täydellinen negatiivinen korrelaatio (toisen muuttujan kasvaessa toinen pienenee) ja 1 on täydellinen positiivinen korrelaatio.</p>
<p>Korrelaation kahden vektorin välillä voi R:ssä laskea komennolla <code>cor()</code>. Otetaan esimerkiksi R:n sisäinen datasetti Indometh, jossa on mitattu indometasiinin farmakokinetiikkaa, ja selvitetään ajan ja indometasiinin konsentraation väliselle riippuvuudelle Pearsonin ja Spearmanin korrelaatiokertoimet. Piirretään sen jälkeen hajontakuvio mittaustuloksista ja lisätään kuvaajaan alaotsikoksi korrelaatiokertoimet. Tutustumme samalla funktioon <code>round()</code>, jolla voi pyöristää lukuja halutulle desimaalitarkkuudelle.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="statistics.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pearson correlation</span></span>
<span id="cb302-2"><a href="statistics.html#cb302-2" aria-hidden="true" tabindex="-1"></a>pearson <span class="ot">&lt;-</span> <span class="fu">cor</span>(Indometh<span class="sc">$</span>time, Indometh<span class="sc">$</span>conc, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb302-3"><a href="statistics.html#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Spearman correlation</span></span>
<span id="cb302-4"><a href="statistics.html#cb302-4" aria-hidden="true" tabindex="-1"></a>spearman <span class="ot">&lt;-</span> <span class="fu">cor</span>(Indometh<span class="sc">$</span>time, Indometh<span class="sc">$</span>conc, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb302-5"><a href="statistics.html#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb302-6"><a href="statistics.html#cb302-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Indometh<span class="sc">$</span>time, Indometh<span class="sc">$</span>conc,</span>
<span id="cb302-7"><a href="statistics.html#cb302-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Concetration&quot;</span>,</span>
<span id="cb302-8"><a href="statistics.html#cb302-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Pharmacokinetics of indometacin&quot;</span>)</span>
<span id="cb302-9"><a href="statistics.html#cb302-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-10"><a href="statistics.html#cb302-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Paste concatenates strings</span></span>
<span id="cb302-11"><a href="statistics.html#cb302-11" aria-hidden="true" tabindex="-1"></a>subtitle <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Pearson correlation:&quot;</span>, <span class="fu">round</span>(pearson, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb302-12"><a href="statistics.html#cb302-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Spearman correlation:&quot;</span>, <span class="fu">round</span>(spearman, <span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb302-13"><a href="statistics.html#cb302-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add subtitle to plot</span></span>
<span id="cb302-14"><a href="statistics.html#cb302-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(subtitle)</span></code></pre></div>
<p><img src="R-ohjelmoinnin-perusteet_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<p>Tässä esimerkissä nähdään hyvin Pearsonin - ja Spearmanin korrelaatiokertoimien ero. Koska Indometasiinin konsentraatio laskee eksponentiaalisesti, ei lineaarisesti, Pearsonin korrelaatiokerroin on “vain” -0.7, kun taas Spearmanin korrelaatiokerroin -0.97 vastaa lähes täydellistä negatiivista korrelaatiota.</p>
</div>
<div id="distributions" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Todennäköisyysjakaumat R:ssä</h2>
<p>Monille yleisimmistä tilastollisista jakaumista eli todennäköisyysjakaumista on valmiita funktiota R:ssä. Funktiota on neljää eri tyyppiä, jotka merkataan funktion nimen ensimmäisellä kirjaimella.</p>
<ul>
<li>d: Tiheysfunktio: mikä on tiheysfunktion arvo pisteessä x?</li>
<li>p: Kertymäfunktio: millä todennäköisyydellä jakaumasta poimittu arvo on pienempi/suurempi kuin q?</li>
<li>q: Käänteinen kertymäfunktio: mille arvolle kertymäfunktio palauttaa todennäköisyyden p?</li>
<li>r: satunnaislukugeneraattori: poimi satunnaisia havaintoja jakaumasta</li>
</ul>
<p>Alla on kuvaajat ensimmäisestä kolmesta funktiosta:</p>
<p><img src="R-ohjelmoinnin-perusteet_files/figure-html/unnamed-chunk-91-1.png" width="960" /></p>
<div id="esimerkki-normaalijakauma" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Esimerkki: normaalijakauma</h3>
<p>Otetaan muutama käytännön esimerkki. Oletetaan, että suomalaisten miesten suolan saanti on normaalijakautunut odotusarvolla 10 grammaa päivässä ja keskihajonta on 4 grammaa päivässä (odotusarvo on totta, keskihajonta allekirjoittaneen hihasta). Piirretään ensin kuva jakaumasta välillä [0, 20] grammaa päivässä. Jakauman muoto saadaan funktiolla <code>dnorm()</code>. Eli yllä olevan ohjeen mukaan d-alkuinen funktio antaa tiheysfunktion, ja norm-pääte viittaa normaalijakaumaan. Normaalijakauman funktiolle tulee kertoa jakauman odotusarvo (mean) ja keskihajonta (sd = standard deviation).</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="statistics.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequential vector  of salt consumption</span></span>
<span id="cb303-2"><a href="statistics.html#cb303-2" aria-hidden="true" tabindex="-1"></a>salt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb303-3"><a href="statistics.html#cb303-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Density function</span></span>
<span id="cb303-4"><a href="statistics.html#cb303-4" aria-hidden="true" tabindex="-1"></a>density <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(salt, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb303-5"><a href="statistics.html#cb303-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Line plot</span></span>
<span id="cb303-6"><a href="statistics.html#cb303-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salt, density, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb303-7"><a href="statistics.html#cb303-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Suolan saanti&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Tiheysfunktio&quot;</span>,</span>
<span id="cb303-8"><a href="statistics.html#cb303-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Suomalaisten miesten suolan saanti&quot;</span>)</span></code></pre></div>
<p><img src="R-ohjelmoinnin-perusteet_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<p>Aikuisten saantisuositus on enintään 5 grammaa suolaa päivässä. Kuinka moni suomalainen mies syö tämän jakauman mukaan sopivasti suolaa? Vastaus saadaan kertymäfunktiosta (P(X &lt; 5)) <code>pnorm()</code> funktion avulla.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="statistics.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.1056498</code></pre>
<p>Tämän jakauman mukaan vain noin 11% suomalaisista miehistä syö suolaa sopivasti!</p>
<p>Suomalaisten naiset syövät keskimäärin 7 grammaa suolaa päivässä. Kuinka moni mies syö tätä enemmän suolaa? <code>pnorm()</code> antaa oletuksena arvon P(X &lt; 7). Nyt halutaan kuitenkin tietää P(X &gt; 7), joka saadaan asettamalla <code>lower.tail = FALSE</code>:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="statistics.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.7733726</code></pre>
<p>Noin 77% miehistä syö suolaa keskimääräistä naista enemmän.</p>
<p>Entä jos halutaan tietää, kuinka paljon suolaa eniten syövä 10% saa? Tähän voidaan vastata funktiolla <code>qnorm()</code>, joka on käänteinen versio funktiosta <code>pnorm()</code>. Samoin kuin <code>pnorm()</code>, <code>qnorm</code>-funktion oletus on, että todennäköisyydet lasketaan jakauman alapäästä alkaen. Vastaus tähän kysymykseen selviää siis näillä kahdella tavalla:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="statistics.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.1</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 15.12621</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="statistics.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb310-2"><a href="statistics.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.9</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 15.12621</code></pre>
<p>Eli tämän jakauman mukaan eniten suolaa saava 10% miehistä syö yli kolminkertaisen määrän suolaa suositukseen verrattuna.</p>
</div>
<div id="muita-jakaumia" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Muita jakaumia</h3>
<p>Vastaavat funktiot löytyvät myös muille jakaumille, kuten:</p>
<ul>
<li>Chi-toiseen: chisq</li>
<li>Eksponentiaalinen: exp</li>
<li>Studentin t: t</li>
<li>Tasajakauma: unif</li>
</ul>
<p>ja niin edelleen.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-ohjelmoinnin perusteet.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
